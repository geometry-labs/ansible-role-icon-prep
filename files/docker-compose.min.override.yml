version: "3.7"

x-disabled-service:
  &disabled-service
    image: tianon/true
    restart: "no"
    command: ""
    entrypoint: ""

services:

  nginx:
    <<: *disabled-service

  prep:
    image: iconloop/${DOCKER_TAG}

    container_name: prep-${NETWORK_NAME}
    environment:

      LOOPCHAIN_LOG_LEVEL: "DEBUG"
      ICON_LOG_LEVEL: "DEBUG"
      FASTEST_START: "yes"
      PRIVATE_KEY_FILENAME: "{{ keystore_path | basename }}"
      PRIVATE_PASSWORD: "{{ keystore_password }}"

    cap_add:
      - SYS_TIME
    volumes:
      - ./data:/data
      - ./cert:/cert
    expose:
      - '9000'
      - '7100'
    restart: on-failure

  node-exporter:
    <<: *disabled-service

  blackbox-exporter:
    <<: *disabled-service

  nginx-exporter-jsonrpc:
    <<: *disabled-service

  cadvisor:
    <<: *disabled-service
